{"ast":null,"code":"import React,{useEffect,useState,useMemo}from'react';import'./Home.css';import{getAllUserLogs,getUserAchievements,updateDrinkingLog}from'../api';import Navbar from'../components/Navbar';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function formatLocalDate(date){const d=new Date(date.getTime());d.setHours(12,0,0,0);const year=d.getFullYear();const month=String(d.getMonth()+1).padStart(2,'0');// months are 0-based\nconst day=String(d.getDate()).padStart(2,'0');return\"\".concat(year,\"-\").concat(month,\"-\").concat(day);}// Helper: Count how many \"sober\" or \"medium\" days in the last 7 days.\nfunction computeWeeklySoberDays(allLogs){const now=new Date();const start=new Date(now.getTime()-6*24*60*60*1000);let count=0;allLogs.forEach(log=>{const d=new Date(log.date);d.setHours(12,0,0,0);if(d>=start&&d<=now&&(log.status==='sober'||log.status==='medium')){count++;}});return count;}// Helper: Count how many months (in the last 12) had no \"heavy\" logs.\nfunction computeMonthsNoCrash(allLogs){const map={};const now=new Date();const last12=new Date(now.getFullYear(),now.getMonth()-12,now.getDate(),0);allLogs.forEach(log=>{const d=new Date(log.date);d.setHours(12,0,0,0);if(d>=last12&&d<=now){const ym=\"\".concat(d.getFullYear(),\"-\").concat(String(d.getMonth()+1).padStart(2,'0'));if(!map[ym])map[ym]=false;if(log.status==='heavy'){map[ym]=true;}}});let count=0;Object.values(map).forEach(val=>{if(val===false)count++;});return count;}/**\n * Reusable Modal component for smooth transitions.\n * When the overlay is clicked, it triggers a fade-out/scale-out animation,\n * then calls onClose() after 300ms.\n */function Modal(_ref){let{children,onClose}=_ref;const[closing,setClosing]=useState(false);const handleClose=()=>{setClosing(true);setTimeout(()=>{onClose();},300);};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay \".concat(closing?'fade-out':'fade-in'),onClick:handleClose,children:/*#__PURE__*/_jsx(\"div\",{className:\"modal-content large-modal \".concat(closing?'scale-out':'scale-in'),onClick:e=>e.stopPropagation(),children:children})});}export default function Home(){const cachedLogs=localStorage.getItem('cachedLogs');const cachedAch=localStorage.getItem('cachedAchievements');const storedUserStr=localStorage.getItem('bacshotsUser');const user=storedUserStr?JSON.parse(storedUserStr):null;const initials=user&&user.name?user.name.split(' ').reduce((acc,cur,idx,arr)=>{if(idx===0||idx===arr.length-1)return acc+cur[0];return acc;},'').toUpperCase():'N';const profileUrl=user===null||user===void 0?void 0:user.profilePicture;const firstName=user!==null&&user!==void 0&&user.name?user.name.split(' ')[0]:'';const[allLogs,setAllLogs]=useState(cachedLogs?JSON.parse(cachedLogs):[]);const[achievements,setAchievements]=useState(cachedAch?JSON.parse(cachedAch):[]);const nowDate=new Date();const[currentYear,setCurrentYear]=useState(nowDate.getFullYear());const[currentMonth,setCurrentMonth]=useState(nowDate.getMonth()+1);const[selectedDate,setSelectedDate]=useState(null);const[isDayPanelOpen,setIsDayPanelOpen]=useState(false);const[weeklyModalOpen,setWeeklyModalOpen]=useState(false);const[monthlyModalOpen,setMonthlyModalOpen]=useState(false);const[achievementsModalOpen,setAchievementsModalOpen]=useState(false);// Fetch logs and achievements only once on mount\nuseEffect(()=>{if(!(user!==null&&user!==void 0&&user._id))return;(async()=>{try{const resLogs=await getAllUserLogs(user._id);if(resLogs&&resLogs.success){setAllLogs(resLogs.logs);localStorage.setItem('cachedLogs',JSON.stringify(resLogs.logs));}}catch(err){console.error(\"Error fetching logs:\",err);}try{const resAch=await getUserAchievements(user._id);if(resAch&&resAch.success){setAchievements(resAch.achievements||[]);localStorage.setItem('cachedAchievements',JSON.stringify(resAch.achievements||[]));}}catch(err){console.error(\"Error fetching achievements:\",err);}})();},[]);// empty dependency array\n// Filter logs for the current month.\nconst monthLogs=useMemo(()=>{return allLogs.filter(log=>{const d=new Date(log.date);return d.getFullYear()===currentYear&&d.getMonth()+1===currentMonth;});},[allLogs,currentYear,currentMonth]);// Build logsMap using normalized local date strings.\nconst logsMap=useMemo(()=>{const map={};monthLogs.forEach(log=>{const d=new Date(log.date);d.setHours(12,0,0,0);const key=formatLocalDate(d);map[key]=log.status;});return map;},[monthLogs]);// getDayClass uses the normalized date string.\nconst getDayClass=dateObj=>{if(!dateObj)return'day-cell day-outside';const d=new Date(dateObj);d.setHours(12,0,0,0);const key=formatLocalDate(d);let statusClass='';if(logsMap[key]==='sober')statusClass='day-sober';if(logsMap[key]==='medium')statusClass='day-medium';if(logsMap[key]==='heavy')statusClass='day-heavy';if(selectedDate){const sel=new Date(selectedDate);sel.setHours(12,0,0,0);if(formatLocalDate(sel)===key){return\"day-cell \".concat(statusClass,\" day-selected\");}}return\"day-cell \".concat(statusClass);};const weeklySoberDays=useMemo(()=>computeWeeklySoberDays(allLogs),[allLogs]);const monthsCrashoutFree=useMemo(()=>computeMonthsNoCrash(allLogs),[allLogs]);const totalAchievements=9;const unlockedCount=achievements.reduce((acc,a)=>a.unlocked?acc+1:acc,0);const fraction=Math.min(unlockedCount/totalAchievements,1);// Build an array of dates for the current month.\nconst getDaysArray=(year,month)=>{const firstDow=new Date(year,month-1,1,12).getDay();const lastDay=new Date(year,month,0).getDate();const arr=[];for(let i=0;i<firstDow;i++){arr.push(null);}for(let d=1;d<=lastDay;d++){arr.push(new Date(year,month-1,d,12));}return arr;};const daysArray=getDaysArray(currentYear,currentMonth);const handleDayClick=dateObj=>{if(!dateObj)return;if(selectedDate&&selectedDate.getTime()===dateObj.getTime()){setIsDayPanelOpen(false);setTimeout(()=>setSelectedDate(null),300);}else{setSelectedDate(dateObj);setIsDayPanelOpen(true);}};// When updating a day's status, normalize the date before storing.\nconst handleUpdateStatus=async status=>{if(!selectedDate||!(user!==null&&user!==void 0&&user._id))return;const normalizedDate=new Date(selectedDate);normalizedDate.setHours(12,0,0,0);const key=formatLocalDate(normalizedDate);try{const res=await updateDrinkingLog(user._id,key,status);if(res&&res.success){setAllLogs(prev=>{const idx=prev.findIndex(lg=>{const dd=new Date(lg.date);dd.setHours(12,0,0,0);return formatLocalDate(dd)===key;});if(idx>=0){const newArr=[...prev];newArr[idx].status=status;return newArr;}else{return[...prev,{user:user._id,date:normalizedDate,status}];}});const resAch=await getUserAchievements(user._id);if(resAch&&resAch.success){setAchievements(resAch.achievements||[]);localStorage.setItem('cachedAchievements',JSON.stringify(resAch.achievements||[]));}}}catch(err){console.error(\"Error updating day log:\",err);}};const handlePrevMonth=()=>{let mo=currentMonth-1;let yr=currentYear;if(mo<1){mo=12;yr--;}setCurrentMonth(mo);setCurrentYear(yr);setIsDayPanelOpen(false);setSelectedDate(null);};const handleNextMonth=()=>{const realY=nowDate.getFullYear();const realM=nowDate.getMonth()+1;let mo=currentMonth+1;let yr=currentYear;if(mo>12){mo=1;yr++;}if(yr>realY||yr===realY&&mo>realM)return;setCurrentMonth(mo);setCurrentYear(yr);setIsDayPanelOpen(false);setSelectedDate(null);};const isCurrentMonth=()=>{const realY=nowDate.getFullYear();const realM=nowDate.getMonth()+1;return currentYear===realY&&currentMonth===realM;};return/*#__PURE__*/_jsxs(\"div\",{className:\"home-container\",children:[/*#__PURE__*/_jsx(Navbar,{onSignOut:()=>{localStorage.removeItem('bacshotsUser');window.location.href='/signin';}}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-main\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"big-profile-container\",children:profileUrl?/*#__PURE__*/_jsx(\"img\",{src:profileUrl,alt:\"Profile\"}):/*#__PURE__*/_jsx(\"div\",{className:\"big-profile-initials\",children:initials||'N'})}),/*#__PURE__*/_jsxs(\"div\",{className:\"greeting dm-sans-semibold\",children:[\"Hello \",firstName,\"!\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stats-box dm-sans-semibold\",onClick:()=>setWeeklyModalOpen(true),children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Your Weekly \",/*#__PURE__*/_jsx(\"br\",{}),\" Stats\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"stats-subtext\",children:[weeklySoberDays,\" days sober this week\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats-box dm-sans-semibold\",onClick:()=>setMonthlyModalOpen(true),children:[/*#__PURE__*/_jsx(\"p\",{children:\"Your Monthly Stats\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"stats-subtext\",children:[monthsCrashoutFree,\" crashout\\u2011free months\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stats-box dm-sans-semibold achievements-box\",onClick:()=>setAchievementsModalOpen(true),children:[/*#__PURE__*/_jsx(\"div\",{className:\"achievements-ring\",children:/*#__PURE__*/_jsxs(\"svg\",{className:\"progress-ring\",width:\"120\",height:\"120\",children:[/*#__PURE__*/_jsx(\"circle\",{stroke:\"#ccc\",strokeWidth:\"10\",fill:\"transparent\",r:50,cx:\"60\",cy:\"60\"}),/*#__PURE__*/_jsx(\"circle\",{stroke:\"#4caf50\",strokeWidth:\"10\",fill:\"transparent\",r:50,cx:\"60\",cy:\"60\",strokeDasharray:\"\".concat(2*Math.PI*50,\" \").concat(2*Math.PI*50),strokeDashoffset:2*Math.PI*50-fraction*(2*Math.PI*50),style:{transition:'stroke-dashoffset 0.5s ease'}}),/*#__PURE__*/_jsxs(\"text\",{x:\"60\",y:\"66\",textAnchor:\"middle\",fontSize:\"20\",fontWeight:\"bold\",fill:\"#333\",children:[unlockedCount,\"/\",totalAchievements]})]})}),/*#__PURE__*/_jsx(\"p\",{children:\"Achievements\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-wrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"cal-nav-btn\",onClick:handlePrevMonth,children:\"\\u2039\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"calendar-month-year dm-sans-semibold\",children:[currentMonth,\"/\",currentYear]}),!isCurrentMonth()&&/*#__PURE__*/_jsx(\"button\",{className:\"cal-nav-btn\",onClick:handleNextMonth,children:\"\\u203A\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"calendar-grid day-labels\",children:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(d=>/*#__PURE__*/_jsx(\"div\",{className:\"day-label\",children:d},d))}),/*#__PURE__*/_jsx(\"div\",{className:\"calendar-grid day-cells\",children:daysArray.map((dt,i)=>/*#__PURE__*/_jsx(\"div\",{className:getDayClass(dt),onClick:()=>handleDayClick(dt),children:dt?dt.getDate():''},i))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"day-status-panel \".concat(selectedDate&&isDayPanelOpen?'open':selectedDate?'opening':'closing'),children:selectedDate&&/*#__PURE__*/_jsxs(\"div\",{className:\"day-status-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-sober\",onClick:()=>handleUpdateStatus('sober'),children:\"I did not drink\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-medium\",onClick:()=>handleUpdateStatus('medium'),children:\"I drank a bit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-heavy\",onClick:()=>handleUpdateStatus('heavy'),children:\"I crashed out\"})]})})]}),weeklyModalOpen&&/*#__PURE__*/_jsxs(Modal,{onClose:()=>setWeeklyModalOpen(false),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"dm-sans-semibold\",children:\"Weekly Stats\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You have been sober \",weeklySoberDays,\" days this week!\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Additional charts can be shown here.\"})]}),monthlyModalOpen&&/*#__PURE__*/_jsxs(Modal,{onClose:()=>setMonthlyModalOpen(false),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"dm-sans-semibold\",children:\"Monthly Stats\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You have \",monthsCrashoutFree,\" crashout\\u2011free months in the last 12 months.\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Additional monthly details can be shown here.\"})]}),achievementsModalOpen&&/*#__PURE__*/_jsxs(Modal,{onClose:()=>setAchievementsModalOpen(false),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"dm-sans-semibold\",children:\"Achievements\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Below are your achievements. A \",/*#__PURE__*/_jsx(\"span\",{className:\"achievement-status unlocked\",children:\"\\u2713\"}),\" indicates you\\u2019ve accomplished it, while a \",/*#__PURE__*/_jsx(\"span\",{className:\"achievement-status locked\",children:\"\\u2715\"}),\" indicates you haven\\u2019t.\"]}),/*#__PURE__*/_jsx(\"ul\",{className:\"achievement-list\",children:achievements.map(ach=>/*#__PURE__*/_jsxs(\"li\",{className:\"achievement-item\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:ach.name}),\" \\u2013 \",ach.description]}),/*#__PURE__*/_jsx(\"div\",{className:\"achievement-status \".concat(ach.unlocked?'unlocked':'locked'),children:ach.unlocked?'✓':'✕'})]},ach.key))})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useMemo","getAllUserLogs","getUserAchievements","updateDrinkingLog","Navbar","jsx","_jsx","jsxs","_jsxs","formatLocalDate","date","d","Date","getTime","setHours","year","getFullYear","month","String","getMonth","padStart","day","getDate","concat","computeWeeklySoberDays","allLogs","now","start","count","forEach","log","status","computeMonthsNoCrash","map","last12","ym","Object","values","val","Modal","_ref","children","onClose","closing","setClosing","handleClose","setTimeout","className","onClick","e","stopPropagation","Home","cachedLogs","localStorage","getItem","cachedAch","storedUserStr","user","JSON","parse","initials","name","split","reduce","acc","cur","idx","arr","length","toUpperCase","profileUrl","profilePicture","firstName","setAllLogs","achievements","setAchievements","nowDate","currentYear","setCurrentYear","currentMonth","setCurrentMonth","selectedDate","setSelectedDate","isDayPanelOpen","setIsDayPanelOpen","weeklyModalOpen","setWeeklyModalOpen","monthlyModalOpen","setMonthlyModalOpen","achievementsModalOpen","setAchievementsModalOpen","_id","resLogs","success","logs","setItem","stringify","err","console","error","resAch","monthLogs","filter","logsMap","key","getDayClass","dateObj","statusClass","sel","weeklySoberDays","monthsCrashoutFree","totalAchievements","unlockedCount","a","unlocked","fraction","Math","min","getDaysArray","firstDow","getDay","lastDay","i","push","daysArray","handleDayClick","handleUpdateStatus","normalizedDate","res","prev","findIndex","lg","dd","newArr","handlePrevMonth","mo","yr","handleNextMonth","realY","realM","isCurrentMonth","onSignOut","removeItem","window","location","href","src","alt","width","height","stroke","strokeWidth","fill","r","cx","cy","strokeDasharray","PI","strokeDashoffset","style","transition","x","y","textAnchor","fontSize","fontWeight","dt","ach","description"],"sources":["C:/Users/melkote/Downloads/ActuallyAlmostFinalizedWaite-main1/ActuallyAlmostFinalizedWaite-main/client/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState, useMemo } from 'react';\nimport './Home.css';\nimport {\n  getAllUserLogs,\n  getUserAchievements,\n  updateDrinkingLog\n} from '../api';\nimport Navbar from '../components/Navbar';\n\n\nfunction formatLocalDate(date) {\n  const d = new Date(date.getTime());\n  d.setHours(12, 0, 0, 0);\n  const year = d.getFullYear();\n  const month = String(d.getMonth() + 1).padStart(2, '0'); // months are 0-based\n  const day = String(d.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\n// Helper: Count how many \"sober\" or \"medium\" days in the last 7 days.\nfunction computeWeeklySoberDays(allLogs) {\n  const now = new Date();\n  const start = new Date(now.getTime() - 6 * 24 * 60 * 60 * 1000);\n  let count = 0;\n  allLogs.forEach((log) => {\n    const d = new Date(log.date);\n    d.setHours(12, 0, 0, 0);\n    if (d >= start && d <= now && (log.status === 'sober' || log.status === 'medium')) {\n      count++;\n    }\n  });\n  return count;\n}\n\n// Helper: Count how many months (in the last 12) had no \"heavy\" logs.\nfunction computeMonthsNoCrash(allLogs) {\n  const map = {};\n  const now = new Date();\n  const last12 = new Date(now.getFullYear(), now.getMonth() - 12, now.getDate(), 0);\n  allLogs.forEach((log) => {\n    const d = new Date(log.date);\n    d.setHours(12, 0, 0, 0);\n    if (d >= last12 && d <= now) {\n      const ym = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;\n      if (!map[ym]) map[ym] = false;\n      if (log.status === 'heavy') {\n        map[ym] = true;\n      }\n    }\n  });\n  let count = 0;\n  Object.values(map).forEach((val) => {\n    if (val === false) count++;\n  });\n  return count;\n}\n\n/**\n * Reusable Modal component for smooth transitions.\n * When the overlay is clicked, it triggers a fade-out/scale-out animation,\n * then calls onClose() after 300ms.\n */\nfunction Modal({ children, onClose }) {\n  const [closing, setClosing] = useState(false);\n  const handleClose = () => {\n    setClosing(true);\n    setTimeout(() => {\n      onClose();\n    }, 300);\n  };\n  return (\n    <div className={`modal-overlay ${closing ? 'fade-out' : 'fade-in'}`} onClick={handleClose}>\n      <div className={`modal-content large-modal ${closing ? 'scale-out' : 'scale-in'}`} onClick={(e) => e.stopPropagation()}>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nexport default function Home() {\n  const cachedLogs = localStorage.getItem('cachedLogs');\n  const cachedAch = localStorage.getItem('cachedAchievements');\n  const storedUserStr = localStorage.getItem('bacshotsUser');\n  const user = storedUserStr ? JSON.parse(storedUserStr) : null;\n  \n  const initials = user && user.name \n    ? user.name.split(' ').reduce((acc, cur, idx, arr) => {\n        if (idx === 0 || idx === arr.length - 1) return acc + cur[0];\n        return acc;\n      }, '').toUpperCase()\n    : 'N';\n  const profileUrl = user?.profilePicture;\n  const firstName = user?.name ? user.name.split(' ')[0] : '';\n\n  const [allLogs, setAllLogs] = useState(cachedLogs ? JSON.parse(cachedLogs) : []);\n  const [achievements, setAchievements] = useState(cachedAch ? JSON.parse(cachedAch) : []);\n  const nowDate = new Date();\n  const [currentYear, setCurrentYear] = useState(nowDate.getFullYear());\n  const [currentMonth, setCurrentMonth] = useState(nowDate.getMonth() + 1);\n  const [selectedDate, setSelectedDate] = useState(null);\n  const [isDayPanelOpen, setIsDayPanelOpen] = useState(false);\n  const [weeklyModalOpen, setWeeklyModalOpen] = useState(false);\n  const [monthlyModalOpen, setMonthlyModalOpen] = useState(false);\n  const [achievementsModalOpen, setAchievementsModalOpen] = useState(false);\n\n  // Fetch logs and achievements only once on mount\n  useEffect(() => {\n    if (!user?._id) return;\n    (async () => {\n      try {\n        const resLogs = await getAllUserLogs(user._id);\n        if (resLogs && resLogs.success) {\n          setAllLogs(resLogs.logs);\n          localStorage.setItem('cachedLogs', JSON.stringify(resLogs.logs));\n        }\n      } catch (err) {\n        console.error(\"Error fetching logs:\", err);\n      }\n      try {\n        const resAch = await getUserAchievements(user._id);\n        if (resAch && resAch.success) {\n          setAchievements(resAch.achievements || []);\n          localStorage.setItem('cachedAchievements', JSON.stringify(resAch.achievements || []));\n        }\n      } catch (err) {\n        console.error(\"Error fetching achievements:\", err);\n      }\n    })();\n  }, []); // empty dependency array\n\n  // Filter logs for the current month.\n  const monthLogs = useMemo(() => {\n    return allLogs.filter((log) => {\n      const d = new Date(log.date);\n      return d.getFullYear() === currentYear && d.getMonth() + 1 === currentMonth;\n    });\n  }, [allLogs, currentYear, currentMonth]);\n\n  // Build logsMap using normalized local date strings.\n  const logsMap = useMemo(() => {\n    const map = {};\n    monthLogs.forEach((log) => {\n      const d = new Date(log.date);\n      d.setHours(12, 0, 0, 0);\n      const key = formatLocalDate(d);\n      map[key] = log.status;\n    });\n    return map;\n  }, [monthLogs]);\n\n  // getDayClass uses the normalized date string.\n  const getDayClass = (dateObj) => {\n    if (!dateObj) return 'day-cell day-outside';\n    const d = new Date(dateObj);\n    d.setHours(12, 0, 0, 0);\n    const key = formatLocalDate(d);\n    let statusClass = '';\n    if (logsMap[key] === 'sober') statusClass = 'day-sober';\n    if (logsMap[key] === 'medium') statusClass = 'day-medium';\n    if (logsMap[key] === 'heavy') statusClass = 'day-heavy';\n    if (selectedDate) {\n      const sel = new Date(selectedDate);\n      sel.setHours(12, 0, 0, 0);\n      if (formatLocalDate(sel) === key) {\n        return `day-cell ${statusClass} day-selected`;\n      }\n    }\n    return `day-cell ${statusClass}`;\n  };\n\n  const weeklySoberDays = useMemo(() => computeWeeklySoberDays(allLogs), [allLogs]);\n  const monthsCrashoutFree = useMemo(() => computeMonthsNoCrash(allLogs), [allLogs]);\n\n  const totalAchievements = 9;\n  const unlockedCount = achievements.reduce((acc, a) => (a.unlocked ? acc + 1 : acc), 0);\n  const fraction = Math.min(unlockedCount / totalAchievements, 1);\n\n  // Build an array of dates for the current month.\n  const getDaysArray = (year, month) => {\n    const firstDow = new Date(year, month - 1, 1, 12).getDay();\n    const lastDay = new Date(year, month, 0).getDate();\n    const arr = [];\n    for (let i = 0; i < firstDow; i++) {\n      arr.push(null);\n    }\n    for (let d = 1; d <= lastDay; d++) {\n      arr.push(new Date(year, month - 1, d, 12));\n    }\n    return arr;\n  };\n  const daysArray = getDaysArray(currentYear, currentMonth);\n\n  const handleDayClick = (dateObj) => {\n    if (!dateObj) return;\n    if (selectedDate && selectedDate.getTime() === dateObj.getTime()) {\n      setIsDayPanelOpen(false);\n      setTimeout(() => setSelectedDate(null), 300);\n    } else {\n      setSelectedDate(dateObj);\n      setIsDayPanelOpen(true);\n    }\n  };\n\n  // When updating a day's status, normalize the date before storing.\n  const handleUpdateStatus = async (status) => {\n    if (!selectedDate || !user?._id) return;\n    const normalizedDate = new Date(selectedDate);\n    normalizedDate.setHours(12, 0, 0, 0);\n    const key = formatLocalDate(normalizedDate);\n    try {\n      const res = await updateDrinkingLog(user._id, key, status);\n      if (res && res.success) {\n        setAllLogs((prev) => {\n          const idx = prev.findIndex((lg) => {\n            const dd = new Date(lg.date);\n            dd.setHours(12, 0, 0, 0);\n            return formatLocalDate(dd) === key;\n          });\n          if (idx >= 0) {\n            const newArr = [...prev];\n            newArr[idx].status = status;\n            return newArr;\n          } else {\n            return [\n              ...prev,\n              { user: user._id, date: normalizedDate, status }\n            ];\n          }\n        });\n        const resAch = await getUserAchievements(user._id);\n        if (resAch && resAch.success) {\n          setAchievements(resAch.achievements || []);\n          localStorage.setItem('cachedAchievements', JSON.stringify(resAch.achievements || []));\n        }\n      }\n    } catch (err) {\n      console.error(\"Error updating day log:\", err);\n    }\n  };\n\n  const handlePrevMonth = () => {\n    let mo = currentMonth - 1;\n    let yr = currentYear;\n    if (mo < 1) {\n      mo = 12;\n      yr--;\n    }\n    setCurrentMonth(mo);\n    setCurrentYear(yr);\n    setIsDayPanelOpen(false);\n    setSelectedDate(null);\n  };\n\n  const handleNextMonth = () => {\n    const realY = nowDate.getFullYear();\n    const realM = nowDate.getMonth() + 1;\n    let mo = currentMonth + 1;\n    let yr = currentYear;\n    if (mo > 12) {\n      mo = 1;\n      yr++;\n    }\n    if (yr > realY || (yr === realY && mo > realM)) return;\n    setCurrentMonth(mo);\n    setCurrentYear(yr);\n    setIsDayPanelOpen(false);\n    setSelectedDate(null);\n  };\n\n  const isCurrentMonth = () => {\n    const realY = nowDate.getFullYear();\n    const realM = nowDate.getMonth() + 1;\n    return currentYear === realY && currentMonth === realM;\n  };\n\n  return (\n    <div className=\"home-container\">\n      <Navbar onSignOut={() => {\n        localStorage.removeItem('bacshotsUser');\n        window.location.href = '/signin';\n      }} />\n      <div className=\"home-main\">\n        <div className=\"big-profile-container\">\n          {profileUrl ? (\n            <img src={profileUrl} alt=\"Profile\" />\n          ) : (\n            <div className=\"big-profile-initials\">{initials || 'N'}</div>\n          )}\n        </div>\n        <div className=\"greeting dm-sans-semibold\">Hello {firstName}!</div>\n        <div className=\"stats-container\">\n          <div className=\"stats-box dm-sans-semibold\" onClick={() => setWeeklyModalOpen(true)}>\n            <p>Your Weekly <br/> Stats</p>\n            <p className=\"stats-subtext\">{weeklySoberDays} days sober this week</p>\n          </div>\n          <div className=\"stats-box dm-sans-semibold\" onClick={() => setMonthlyModalOpen(true)}>\n            <p>Your Monthly Stats</p>\n            <p className=\"stats-subtext\">{monthsCrashoutFree} crashout‑free months</p>\n          </div>\n          <div className=\"stats-box dm-sans-semibold achievements-box\" onClick={() => setAchievementsModalOpen(true)}>\n            <div className=\"achievements-ring\">\n              <svg className=\"progress-ring\" width=\"120\" height=\"120\">\n                <circle stroke=\"#ccc\" strokeWidth=\"10\" fill=\"transparent\" r={50} cx=\"60\" cy=\"60\" />\n                <circle\n                  stroke=\"#4caf50\"\n                  strokeWidth=\"10\"\n                  fill=\"transparent\"\n                  r={50}\n                  cx=\"60\"\n                  cy=\"60\"\n                  strokeDasharray={`${2 * Math.PI * 50} ${2 * Math.PI * 50}`}\n                  strokeDashoffset={2 * Math.PI * 50 - fraction * (2 * Math.PI * 50)}\n                  style={{ transition: 'stroke-dashoffset 0.5s ease' }}\n                />\n                <text x=\"60\" y=\"66\" textAnchor=\"middle\" fontSize=\"20\" fontWeight=\"bold\" fill=\"#333\">\n                  {unlockedCount}/{totalAchievements}\n                </text>\n              </svg>\n            </div>\n            <p>Achievements</p>\n          </div>\n        </div>\n        <div className=\"calendar-wrapper\">\n          <div className=\"calendar-header\">\n            <button className=\"cal-nav-btn\" onClick={handlePrevMonth}>‹</button>\n            <div className=\"calendar-month-year dm-sans-semibold\">\n              {currentMonth}/{currentYear}\n            </div>\n            {!isCurrentMonth() && (\n              <button className=\"cal-nav-btn\" onClick={handleNextMonth}>›</button>\n            )}\n          </div>\n          <div className=\"calendar-grid day-labels\">\n            {['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map((d) => (\n              <div key={d} className=\"day-label\">{d}</div>\n            ))}\n          </div>\n          <div className=\"calendar-grid day-cells\">\n            {daysArray.map((dt, i) => (\n              <div key={i} className={getDayClass(dt)} onClick={() => handleDayClick(dt)}>\n                {dt ? dt.getDate() : ''}\n              </div>\n            ))}\n          </div>\n        </div>\n        <div className={`day-status-panel ${selectedDate && isDayPanelOpen ? 'open' : selectedDate ? 'opening' : 'closing'}`}>\n          {selectedDate && (\n            <div className=\"day-status-buttons\">\n              <button className=\"btn-sober\" onClick={() => handleUpdateStatus('sober')}>I did not drink</button>\n              <button className=\"btn-medium\" onClick={() => handleUpdateStatus('medium')}>I drank a bit</button>\n              <button className=\"btn-heavy\" onClick={() => handleUpdateStatus('heavy')}>I crashed out</button>\n            </div>\n          )}\n        </div>\n      </div>\n      {weeklyModalOpen && (\n        <Modal onClose={() => setWeeklyModalOpen(false)}>\n          <h2 className=\"dm-sans-semibold\">Weekly Stats</h2>\n          <p>You have been sober {weeklySoberDays} days this week!</p>\n          <p>Additional charts can be shown here.</p>\n        </Modal>\n      )}\n      {monthlyModalOpen && (\n        <Modal onClose={() => setMonthlyModalOpen(false)}>\n          <h2 className=\"dm-sans-semibold\">Monthly Stats</h2>\n          <p>You have {monthsCrashoutFree} crashout‑free months in the last 12 months.</p>\n          <p>Additional monthly details can be shown here.</p>\n        </Modal>\n      )}\n      {achievementsModalOpen && (\n        <Modal onClose={() => setAchievementsModalOpen(false)}>\n          <h2 className=\"dm-sans-semibold\">Achievements</h2>\n          <p>\n            Below are your achievements. A <span className=\"achievement-status unlocked\">✓</span> indicates you’ve accomplished it, while a <span className=\"achievement-status locked\">✕</span> indicates you haven’t.\n          </p>\n          <ul className=\"achievement-list\">\n            {achievements.map((ach) => (\n              <li key={ach.key} className=\"achievement-item\">\n                <div>\n                  <strong>{ach.name}</strong> – {ach.description}\n                </div>\n                <div className={`achievement-status ${ach.unlocked ? 'unlocked' : 'locked'}`}>\n                  {ach.unlocked ? '✓' : '✕'}\n                </div>\n              </li>\n            ))}\n          </ul>\n        </Modal>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}