{"ast":null,"code":"import React,{useState,useRef}from'react';import{useNavigate,Link}from'react-router-dom';import{verifyEmail,resend}from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CodeInput(_ref){let{value,onChange}=_ref;const inputsRef=useRef([]);const length=6;const handleChange=(e,index)=>{const char=e.target.value.toUpperCase();let newVal=value.split('');newVal[index]=char;while(newVal.length<length){newVal.push('');}const newCode=newVal.slice(0,length).join('');onChange(newCode);if(char&&index<length-1){inputsRef.current[index+1].focus();}};const handleKeyDown=(e,index)=>{if(e.key==='Backspace'){e.preventDefault();let newVal=value.split('');if(newVal[index]){newVal[index]='';onChange(newVal.join(''));}else if(index>0){inputsRef.current[index-1].focus();let prevVal=value.split('');prevVal[index-1]='';onChange(prevVal.join(''));}}};const handlePaste=e=>{e.preventDefault();const pasteData=e.clipboardData.getData('text').toUpperCase().replace(/\\s/g,'');let pasteChars=pasteData.split('').slice(0,length);while(pasteChars.length<length){pasteChars.push('');}const newCode=pasteChars.join('');onChange(newCode);const lastIndex=Math.min(pasteChars.length,length)-1;if(inputsRef.current[lastIndex]){inputsRef.current[lastIndex].focus();}};const codeArray=[];for(let i=0;i<length;i++){codeArray.push(value[i]||'');}return/*#__PURE__*/_jsx(\"div\",{className:\"code-input-container\",children:codeArray.map((char,index)=>/*#__PURE__*/_jsx(\"input\",{type:\"text\",maxLength:\"1\",value:char,onChange:e=>handleChange(e,index),onKeyDown:e=>handleKeyDown(e,index),onPaste:handlePaste,ref:el=>inputsRef.current[index]=el,className:\"code-input-bubble\"},index))});}export default function Verify(_ref2){let{userSignupData}=_ref2;const navigate=useNavigate();const[code,setCode]=useState('');const[errorMsg,setErrorMsg]=useState(null);const[successMsg,setSuccessMsg]=useState(null);const handleVerify=async e=>{e.preventDefault();setErrorMsg(null);const email=userSignupData.email;if(!email){return setErrorMsg('No email to verify. Please sign up first.');}try{const result=await verifyEmail(email,code);if(result.message&&result.message.includes('successfully')){setSuccessMsg(result.message);setTimeout(()=>{navigate('/signin');},1500);}else{setErrorMsg(result.message||'Verification failed.');}}catch(err){console.error(err);setErrorMsg('Failed to reach server. Please try again later.');}};const handleResend=async()=>{setErrorMsg(null);setSuccessMsg(null);const email=userSignupData.email;if(!email){return setErrorMsg('No email to resend. Please sign up first.');}try{const result=await resend(email);if(result.message&&result.message.toLowerCase().includes('resent')){setSuccessMsg(result.message);}else{setErrorMsg(result.message||'Resend failed.');}}catch(err){console.error(err);setErrorMsg('Failed to reach server. Please try again later.');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Verify Your Email\"}),/*#__PURE__*/_jsx(\"p\",{className:\"subheader\",children:\"We\\u2019ve emailed you a 6-digit code. Enter it below to verify your account.\"}),errorMsg&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errorMsg}),successMsg&&/*#__PURE__*/_jsx(\"div\",{className:\"success\",children:successMsg}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleVerify,style:{marginTop:'1rem'},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CodeInput,{value:code,onChange:setCode})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{marginTop:'1rem'},children:\"Verify\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:handleResend,style:{marginTop:'0.75rem'},children:\"Resend Code\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-links\",style:{display:'flex',flexDirection:'column',alignItems:'center',marginTop:'1rem'},children:/*#__PURE__*/_jsx(Link,{to:\"/signin\",children:\"Sign In\"})})]});}","map":{"version":3,"names":["React","useState","useRef","useNavigate","Link","verifyEmail","resend","jsx","_jsx","jsxs","_jsxs","CodeInput","_ref","value","onChange","inputsRef","length","handleChange","e","index","char","target","toUpperCase","newVal","split","push","newCode","slice","join","current","focus","handleKeyDown","key","preventDefault","prevVal","handlePaste","pasteData","clipboardData","getData","replace","pasteChars","lastIndex","Math","min","codeArray","i","className","children","map","type","maxLength","onKeyDown","onPaste","ref","el","Verify","_ref2","userSignupData","navigate","code","setCode","errorMsg","setErrorMsg","successMsg","setSuccessMsg","handleVerify","email","result","message","includes","setTimeout","err","console","error","handleResend","toLowerCase","onSubmit","style","marginTop","onClick","display","flexDirection","alignItems","to"],"sources":["C:/Users/melkote/Downloads/ActuallyAlmostFinalizedWaite-main1/ActuallyAlmostFinalizedWaite-main/client/src/pages/Verify.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { verifyEmail, resend } from '../api';\n\nfunction CodeInput({ value, onChange }) {\n  const inputsRef = useRef([]);\n  const length = 6;\n  \n  const handleChange = (e, index) => {\n    const char = e.target.value.toUpperCase();\n    let newVal = value.split('');\n    newVal[index] = char;\n    while (newVal.length < length) {\n      newVal.push('');\n    }\n    const newCode = newVal.slice(0, length).join('');\n    onChange(newCode);\n    if (char && index < length - 1) {\n      inputsRef.current[index + 1].focus();\n    }\n  };\n\n  const handleKeyDown = (e, index) => {\n    if (e.key === 'Backspace') {\n      e.preventDefault();\n      let newVal = value.split('');\n      if (newVal[index]) {\n        newVal[index] = '';\n        onChange(newVal.join(''));\n      } else if (index > 0) {\n        inputsRef.current[index - 1].focus();\n        let prevVal = value.split('');\n        prevVal[index - 1] = '';\n        onChange(prevVal.join(''));\n      }\n    }\n  };\n\n  const handlePaste = (e) => {\n    e.preventDefault();\n    const pasteData = e.clipboardData.getData('text').toUpperCase().replace(/\\s/g, '');\n    let pasteChars = pasteData.split('').slice(0, length);\n    while (pasteChars.length < length) {\n      pasteChars.push('');\n    }\n    const newCode = pasteChars.join('');\n    onChange(newCode);\n    const lastIndex = Math.min(pasteChars.length, length) - 1;\n    if (inputsRef.current[lastIndex]) {\n      inputsRef.current[lastIndex].focus();\n    }\n  };\n\n  const codeArray = [];\n  for (let i = 0; i < length; i++) {\n    codeArray.push(value[i] || '');\n  }\n\n  return (\n    <div className=\"code-input-container\">\n      {codeArray.map((char, index) => (\n        <input\n          key={index}\n          type=\"text\"\n          maxLength=\"1\"\n          value={char}\n          onChange={(e) => handleChange(e, index)}\n          onKeyDown={(e) => handleKeyDown(e, index)}\n          onPaste={handlePaste}\n          ref={(el) => (inputsRef.current[index] = el)}\n          className=\"code-input-bubble\"\n        />\n      ))}\n    </div>\n  );\n}\n\nexport default function Verify({ userSignupData }) {\n  const navigate = useNavigate();\n  const [code, setCode] = useState('');\n  const [errorMsg, setErrorMsg] = useState(null);\n  const [successMsg, setSuccessMsg] = useState(null);\n\n  const handleVerify = async (e) => {\n    e.preventDefault();\n    setErrorMsg(null);\n\n    const email = userSignupData.email;\n    if (!email) {\n      return setErrorMsg('No email to verify. Please sign up first.');\n    }\n\n    try {\n      const result = await verifyEmail(email, code);\n      if (result.message && result.message.includes('successfully')) {\n        setSuccessMsg(result.message);\n        setTimeout(() => {\n          navigate('/signin');\n        }, 1500);\n      } else {\n        setErrorMsg(result.message || 'Verification failed.');\n      }\n    } catch (err) {\n      console.error(err);\n      setErrorMsg('Failed to reach server. Please try again later.');\n    }\n  };\n\n  const handleResend = async () => {\n    setErrorMsg(null);\n    setSuccessMsg(null);\n\n    const email = userSignupData.email;\n    if (!email) {\n      return setErrorMsg('No email to resend. Please sign up first.');\n    }\n\n    try {\n      const result = await resend(email);\n      if (result.message && result.message.toLowerCase().includes('resent')) {\n        setSuccessMsg(result.message);\n      } else {\n        setErrorMsg(result.message || 'Resend failed.');\n      }\n    } catch (err) {\n      console.error(err);\n      setErrorMsg('Failed to reach server. Please try again later.');\n    }\n  };\n\n  return (\n    <div className=\"card\">\n      <h2>Verify Your Email</h2>\n      <p className=\"subheader\">\n        Weâ€™ve emailed you a 6-digit code. Enter it below to verify your account.\n      </p>\n\n      {errorMsg && <div className=\"error\">{errorMsg}</div>}\n      {successMsg && <div className=\"success\">{successMsg}</div>}\n\n      <form onSubmit={handleVerify} style={{ marginTop: '1rem' }}>\n        <div>\n          <CodeInput value={code} onChange={setCode} />\n        </div>\n\n        <button type=\"submit\" style={{ marginTop: '1rem' }}>\n          Verify\n        </button>\n      </form>\n\n      <button\n        className=\"btn-secondary\"\n        onClick={handleResend}\n        style={{ marginTop: '0.75rem' }}\n      >\n        Resend Code\n      </button>\n\n      <div\n        className=\"form-links\"\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          marginTop: '1rem',\n        }}\n      >\n        <Link to=\"/signin\">Sign In</Link>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}